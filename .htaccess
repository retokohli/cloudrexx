# <contrexx>
#  <core_routing>
    RewriteEngine On

    #RewriteLog "logs/rewrite.log"
    #RewriteLogLevel 9

    # This is ASCMS_PATH_OFFSET, i.e.
    RewriteBase   /trunk
        
    # Remove trailing slash for old Apaches (newer ones stop rewriting when result matches request)
    #RewriteRule ^(\w\w\/)?(_meta|cache|changelog|config|core|core_modules|customizing|feed|images|installer|lang|lib|media|model|modules|testing|themes|tmp|update|webcam|favicon.ico)\/$ $2 [L,QSA]

    # Folders that may be accessed by page requests are NO ALIASES by design
    RewriteRule ^(\w\w\/)?(_meta|cache|changelog|config|core|core_modules|customizing|feed|images|installer|lang|lib|media|model|modules|testing|themes|tmp|update|webcam|favicon.ico)(\/|$)(.*) $2$3$4 [L,QSA]

    # Resolve language specific sitemap.xml
    RewriteRule ^(\w+)\/sitemap.xml sitemap_$1.xml [L,NC]

    # Anything that is neither a directory nor a file *might* be an alias.
    # Append the entire request to the query string.
    # See core/Dispatcher.class.php, look for "CONTREXX_ALIAS_PARAMETER"
    # The Dispatcher will decide.
    # Warning: Overhead!
    RewriteCond   %{REQUEST_FILENAME}  index.php [OR]
    RewriteCond   %{REQUEST_URI} cadmin/$
    RewriteRule   .  index.php?__cap=%{REQUEST_URI} [L,QSA]

    RewriteCond   %{REQUEST_FILENAME}  !-d
    RewriteCond   %{REQUEST_FILENAME}  !-f
    RewriteRule   .  index.php?__cap=%{REQUEST_URI} [L,QSA]
#  </core_routing>
# </contrexx>
